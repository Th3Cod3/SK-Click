{% extends 'layout.twig' %}
{% block content %}
	<div class="mt-5">
		<div class="container-md">
			<div class="card">
				<div class="card-header text-center font-weight-bold">
					Divisions
					<span class="float-right">
						<button class="btn btn-success btn-sm" data-target="btn-division" data-ajax="edit">Add Division</button>
					</span>
				</div>
				<div class="card-body main-card">
					<div class="row" id="divisions-menu">
						<div class="col-12" v-show="load">
							<div class="d-flex justify-content-center">
								<div class="spinner-border text-dark" role="status">
									<span class="sr-only">Loading...</span>
								</div>
							</div>
						</div>
						<div class="col-md-6 col-sm-12 mb-3" v-for="division in divisions">
							<division-card v-bind:division="division">
							</division-card>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
{% endblock %}

{% block javascript %}
	<script>
		Vue.component('divisionCard', {
			props: ['division'],
			delimiters: ["#{", "}"],
			data: function () {
				return {
					count: 0
				}
			},
			computed: {
				divisionUrl: function () {
					return '{{ "" | url }}manage/' + this.division.url
				}
			},
			template: `
				<a class="card bg-secondary text-white" v-bind:href="divisionUrl">
					<div class="card-header font-weight-bold">
						#{ division.name }
					</div>
					<div class="card-body">
						#{ division.description }
					</div>
				</a>
			`
		});
		let division = new Vue({
			el: "#app-body",
			delimiters: ["#{", "}"],
			data(){
				return {
					divisions: [],
					load: true
				}
			},
			created: function (){
				let self = this
				loadData("divisions")
					.then(data => {
						self.divisions = data.divisions;
						self.load = false;
					})
			}
		});
	</script>
{% endblock %}
